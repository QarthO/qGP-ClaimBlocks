package gg.quartzdev.qgpclaimblocks.listeners;

import gg.quartzdev.qgpclaimblocks.util.PDC;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.entity.EntityDropItemEvent;
import org.bukkit.event.entity.EntityPickupItemEvent;

public class ExploitListener implements Listener {
    /*
    When working with custom GUIs there is always the scare of an item from the GUI
    being duped, or glitched out. To prevent this every item in the GUI has a custom nbt value on it, a 'mark'.
    We then listen for anytime a player interacts with any every item. If any those items are 'marked' we log
    the situation to console and then delete it.

    Currently, in all of our plugins we've had zero reports of any logs about a marked item or any exploits.
    Even if its needlessly redundant, this system is strictly to ensure all of our plugins are safe to use.
     */

    public ExploitListener(){

    }

    /**
     *
     * @param event
     */
    @EventHandler
    private void PickupItem(EntityPickupItemEvent event){
        // checks if the item is a marked item
        if(!PDC.isMarked(event.getItem())) return;
        // prevents the player from picking it up
        event.setCancelled(true);
        // deletes the item
        event.getItem().remove();
    }

    /**
     *
     * @param event
     */
    @EventHandler
    private void DropItem(EntityDropItemEvent event){
        // checks if the item is a marked item
        if(!PDC.isMarked(event.getItemDrop())) return;
        // prevents the player from picking it up
        event.setCancelled(true);
        // deletes the item
        event.getItemDrop().remove();
    }

}
